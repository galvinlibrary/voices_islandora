# This migration shows importing from a single XML file.
id: tax_pers_xxx
label: Person Taxonomy
migration_group: default
source:
  constants:
    pathalias: '/person/'
  plugin: url
  # This is one or more fully-qualified URLs or file paths.
  urls: 
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/odinetsD.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/tischauerH.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/brinI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/rosetR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/ostlandI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/breslauerA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/franzH.xml"    
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/gutmanE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kimmelmannA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/moellerE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kalnietisJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kahnM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/frimL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/boguslaw.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/krakowskiA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/billiT.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/wilfJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/bondyN.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/freilichF.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kahnL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/jeanC.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schrameckA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/bisenhausP.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schwarzfitterJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kluverJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/weinbergJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/buttonE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/benmayorR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/josephyK.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/finkelN.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/minskiJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/sochamiH.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/zeplitR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/matznerJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/gertnerA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schiverT.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kahnJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/piskorzB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/stopnitskyU.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/milgramM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/lukoseviciusV.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/nehrichW.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/johlesM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/warsagerB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/neufeldH.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/golenJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/reichS.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/mizrachiM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schultzeC.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/joseph.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/deutschY.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/buttonJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/isakovitchS.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/braunA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/rosenfeldP.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/serrasE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/ziererE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/monkF.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/frydmanH.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/zgnilekB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/hamburgerL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/feuerO.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/meltzakR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schachtN.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/borgman_freinhofferJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/leaD.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/unikowskiI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/bramsonJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kestenbergJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/marsonM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/wolfI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/gurmanovaR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/moskovitzM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/freilichE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/grossJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/silberbartG.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/oleiskiJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kharchenkoI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/tcharnabrodaR.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/zurilisS.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kruegerE.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/marcusH.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kuechlerL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/bassfreundJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/schlaefrigF.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/stumachinL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/aIlmar.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/rudo.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/skudaikieneB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/suvalkaitisA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/michelsonV.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/nichthauserF.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kaletskaA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/friedmanB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/feneger.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/linikD.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/kaldoreG.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/paulA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/heislerA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/shachnovskiL.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/herskovitzM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/paulisA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/ferberJ.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/hirschD.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/goldwasserB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/rosenwasserI.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/preckerM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/ferdinanskV.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/neimanC.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/horowitzS.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/czolopickiB.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/eisenbergK.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/sprecherM.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/bJanis.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/richardA.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/epsteinN.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/barzilaiN.xml"
    - "http://digital.library.iit.edu/sites/default/files/voices_fix/lipschitzM.xml"

  data_fetcher_plugin: http
  data_parser_plugin: xml
  #namespaces:
  #	xi: http://www.w3.org/2001/XInclude

  # The item_selector value is the xpath to use to query the elements.
  item_selector: /TEI/teiHeader/profileDesc/particDesc/listPerson
  
  # Under 'fields', we list the data items to be imported. The first level keys
  # are the source field names we want to populate (the names to be used as
  # sources in the process configuration below). For each field we're importing,
  # we provide a label (optional - this is for display in migration tools) and
  # an xpath for retrieving that value. It's important to note that this xpath
  # is relative to the elements retrieved by item_xpath.
  
  fields:
    -
      name: surname
      label: 'Page Title'
      selector: 'person[@role="interviewee"][1]/persName[1]/surname[1]'
    -
      name: firstname
      label: 'Unique Id'
      selector: 'person[@role="interviewee"][1]/persName[1]/forename[1]'
    -
      name: gender
      label: 'Gender'
      selector: 'person[@role="interviewee"][1]/sex[1]'
    -
      name: age
      label: 'Age at time of interview'
      selector: 'person[@role="interviewee"][1]/age[1]'
    -
      name: birth
      label: 'Date of Birth'
      selector: 'person[@role="interviewee"][1]/birth[1]/@when'
    -
      name: faith
      label: 'Religious Faith'
      selector: 'person[@role="interviewee"][1]/faith[1]'
    -
      name: nationality
      label: 'nationality'
      selector: 'person[@role="interviewee"][1]/nationality[1]/@key'
    -
      name: marital_status
      label: 'Marital Status'
      selector: 'person[@role="interviewee"][1]/state[@type="marital_status"]/desc[1]'
    -
      name: holocaust_role
      label: 'Role During Holocaust'
      selector: 'person[@role="interviewee"][1]/trait[@type="role_during_holocaust"]/desc[1]'
    -
      name: tattoo
      label: 'Role During Holocaust'
      selector: 'person[@role="interviewee"][1]/trait[@type="tattoo"]/desc[1]'
    -
      name: legacy_uid
      label: 'UID from old voices site'
      selector: 'person[@role="interviewee"][1]/@id[1]'
    -
      name: birthplace
      label: 'Place of birth'
      selector: 'person[@role="interviewee"][1]/birth[1]/@ref'
    -
      name: internment
      lablel: 'Place of internment'
      selector: 'person[@role="interviewee"][1]/event[@type="internment"]/@ref'
    -
      name: liberation
      lablel: 'location at time of liberation'
      selector: 'person[@role="interviewee"][1]/event[@type="liberation"]/@ref'
    -
      name: invasion
      lablel: 'location at time of invasion'
      selector: 'person[@role="interviewee"][1]/event[@type="invasion"]/@ref'
    -
      name: liberation_date
      lablel: 'date at time of liberation'
      selector: 'person[@role="interviewee"][1]/event[@type="liberation"]/@when'
    -
      name: alias
      label: 'Person Alias'
      selector: 'person[@role="interviewee"][1]/persName[@type="alias"]/name'

  # Under 'ids', we identify source fields populated above which will uniquely
  # identify each imported item.

  ids:
    surname:
      type: string
process:
  vid:
    plugin: default_value
    default_value: person
  name: 
    plugin: concat
    source:
      - firstname
      - surname
    delimiter: ' '
  'field_person_preferred_name/family': surname 
  'field_person_preferred_name/given': firstname
  #field_test_plain_text: internment
  field_gender: gender
  'path/alias':
    plugin: concat
    source:
      - constants/pathalias
      - surname
  field_cat_date_begin: birth
  #field_cat_date_end: death
  field_marital_status: marital_status
  field_role_during_the_holocaust: holocaust_role
  field_tattoo: tattoo
  field_PLACEHOLDER_legacy_uid: legacy_uid
  field_faith: faith
  field_age: age
  field_liberationlocation:
    plugin: entity_lookup
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: geo_location
    value_key: name
    ignore_case: true
    source: liberation
  field_date_of_liberation: liberation_date
  field_internmentlocation:
    plugin: entity_lookup
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: camps_ghettos
    value_key: name
    ignore_case: true
    source: internment
  'field_birthplace/rel_type':
    plugin: default_value
    default_value: schema:birthPlace
  'field_birthplace/target_id':
    plugin: entity_lookup
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: geo_location
    value_key: name
    ignore_case: true
    source: birthplace
  'field_nationality/rel_type':
    plugin: default_value
    default_value: schema:nationality 
  'field_nationality/target_id':
    plugin: entity_lookup
    entity_type: taxonomy_term
    bundle_key: vid
    bundle: geo_location
    value_key: name
    ignore_case: true
    source: nationality
    
destination:
  plugin: entity:taxonomy_term
migration_dependencies: {}
